<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›¾ç‰‡åæ ‡é€‰å–å·¥å…·ä¸æ•°æ®çœ‹æ¿ - å•†å®¶åç§°é›†æˆç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 20px 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 8px;
        }
        
        .subtitle {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .tab-menu {
            display: flex;
            background-color: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }
        
        .tab-button {
            padding: 12px 24px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            color: #6c757d;
            border-bottom: 3px solid transparent;
        }
        
        .tab-button.active {
            color: #2575fc;
            border-bottom: 3px solid #2575fc;
            background-color: white;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
        }
        
        .tab-content.active {
            display: flex;
            flex-wrap: wrap;
        }
        
        .image-section {
            flex: 1;
            min-width: 400px;
            padding: 15px;
        }
        
        .image-container-wrapper {
            position: relative;
            border: 2px dashed #ddd;
            border-radius: 8px;
            overflow: hidden;
            background-color: #f9f9f9;
            margin-bottom: 15px;
            display: inline-block;
        }
        
        .image-container {
            position: relative;
            display: inline-block;
            line-height: 0;
        }
        
        #target-image {
            max-width: 100%;
            max-height: 80vh;
            cursor: crosshair;
            display: block;
        }
        
        .point-marker {
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }
        
        .point-marker:hover {
            transform: translate(-50%, -50%) scale(1.2);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
        }
        
        .point-1 {
            background-color: #ff4757;
        }
        
        .point-2 {
            background-color: #2ed573;
        }
        
        .point-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 20;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            font-weight: 500;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s, transform 0.3s;
            pointer-events: none;
        }
        
        .point-tooltip.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .point-tooltip::after {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border-style: solid;
        }
        
        .point-tooltip.top {
            transform: translate(-50%, -100%);
            margin-top: -10px;
        }
        
        .point-tooltip.top::after {
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border-width: 8px 6px 0 6px;
            border-color: rgba(0, 0, 0, 0.85) transparent transparent transparent;
        }
        
        .point-tooltip.bottom {
            transform: translate(-50%, 0);
            margin-top: 10px;
        }
        
        .point-tooltip.bottom::after {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border-width: 0 6px 8px 6px;
            border-color: transparent transparent rgba(0, 0, 0, 0.85) transparent;
        }
        
        .point-tooltip.right {
            transform: translate(0, -50%);
            margin-left: 10px;
        }
        
        .point-tooltip.right::after {
            right: 100%;
            top: 50%;
            transform: translateY(-50%);
            border-width: 6px 8px 6px 0;
            border-color: transparent rgba(0, 0, 0, 0.85) transparent transparent;
        }
        
        .point-tooltip.left {
            transform: translate(-100%, -50%);
            margin-left: -10px;
        }
        
        .point-tooltip.left::after {
            left: 100%;
            top: 50%;
            transform: translateY(-50%);
            border-width: 6px 0 6px 8px;
            border-color: transparent transparent transparent rgba(0, 0, 0, 0.85);
        }
        
        .image-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #6c757d;
            font-size: 16px;
            z-index: 5;
        }
        
        .image-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .file-upload-btn, .url-load-btn {
            flex: 1;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            background-color: white;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }
        
        .file-upload-btn:hover, .url-load-btn:hover {
            background-color: #f8f9fa;
        }
        
        #file-input {
            display: none;
        }
        
        .url-input-container {
            display: flex;
            gap: 10px;
        }
        
        #image-url {
            flex: 1;
            padding: 10px 12px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 14px;
        }
        
        #load-url-btn {
            padding: 10px 20px;
            background-color: #2575fc;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        #load-url-btn:hover {
            background-color: #1a68e8;
        }
        
        .control-section {
            flex: 1;
            min-width: 300px;
            padding: 15px;
        }
        
        .control-panel {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }
        
        input, select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #6a11cb;
            box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.1);
        }
        
        .coordinates {
            display: flex;
            gap: 15px;
        }
        
        .coordinate-group {
            flex: 1;
        }
        
        .direction-select {
            position: relative;
        }
        
        .direction-select::after {
            content: "â–¼";
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
            color: #6c757d;
        }
        
        button {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(106, 17, 203, 0.3);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .data-section {
            margin-top: 25px;
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
        }
        
        .json-output {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .instructions {
            width: 100%;
            margin-top: 20px;
            padding: 25px;
            background-color: #e8f4fd;
            border-left: 4px solid #2575fc;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.8;
        }
        
        .instructions h3 {
            margin-bottom: 15px;
            color: #2575fc;
        }
        
        .instructions ol {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 10px;
        }
        
        .instructions p {
            margin-bottom: 10px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .action-buttons button {
            flex: 1;
            min-width: 120px;
        }
        
        #reset-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
        }
        
        #submit-data-btn {
            background: linear-gradient(135deg, #2ed573 0%, #1ed96f 100%);
        }
        
        #submit-data-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        #submit-data-btn:disabled:hover {
            transform: none;
            box-shadow: none;
        }
        
        .point-status {
            margin-top: 10px;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .point-status.incomplete {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .point-status.complete {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        /* å•†å®¶åç§°è¾“å…¥æ¡†æ ·å¼ */
        .merchant-input-container {
            position: relative;
        }
        
        .merchant-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ced4da;
            border-top: none;
            border-radius: 0 0 6px 6px;
            max-height: 150px;
            overflow-y: auto;
            z-index: 100;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            display: none;
        }
        
        .merchant-suggestion {
            padding: 10px 12px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .merchant-suggestion:hover {
            background-color: #f8f9fa;
        }
        
        .merchant-suggestion.active {
            background-color: #e9ecef;
        }
        
        /* æ•°æ®çœ‹æ¿æ ·å¼ */
        .dashboard {
            width: 100%;
            padding: 20px;
        }
        
        .dashboard-header {
            margin-bottom: 30px;
            text-align: center;
        }
        
        .dashboard-header h2 {
            font-size: 24px;
            color: #2575fc;
            margin-bottom: 10px;
        }
        
        .dashboard-content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .chart-container {
            flex: 1;
            min-width: 300px;
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
        }
        
        .chart-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #495057;
            text-align: center;
        }
        
        .stats-cards {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .stat-card {
            flex: 1;
            min-width: 200px;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .time-filter {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .time-btn {
            padding: 8px 16px;
            background-color: #e9ecef;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .time-btn.active {
            background-color: #2575fc;
            color: white;
        }
        
        /* æç¤ºæ¡†æ ·å¼ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.3s ease-in-out;
            max-width: 400px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background: linear-gradient(135deg, #2ed573 0%, #1ed96f 100%);
        }
        
        .notification.error {
            background: linear-gradient(135deg, #ff4757 0%, #ff3742 100%);
        }
        
        .notification.warning {
            background: linear-gradient(135deg, #ffa502 0%, #ff9f1a 100%);
        }
        
        .notification.info {
            background: linear-gradient(135deg, #2f3542 0%, #57606f 100%);
        }
        
        .notification-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notification-icon {
            font-size: 20px;
        }
        
        .notification-close {
            background: none;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            margin-left: auto;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .image-section, .control-section {
                min-width: 100%;
            }
            
            .image-controls {
                flex-direction: column;
            }
            
            .url-input-container {
                flex-direction: column;
            }
            
            .tab-content.active {
                flex-direction: column;
            }
            
            .dashboard-content {
                flex-direction: column;
            }
            
            .notification {
                left: 20px;
                right: 20px;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>å›¾ç‰‡åæ ‡é€‰å–å·¥å…·ä¸æ•°æ®çœ‹æ¿ - å•†å®¶åç§°é›†æˆç‰ˆ</h1>
            <p class="subtitle">åæ ‡é€‰å–ä¸è¿›å‡ºäººæ•°å¯è§†åŒ–åˆ†æ</p>
        </header>
        
        <div class="tab-menu">
            <button class="tab-button active" data-tab="coordinate-tool">åæ ‡é€‰å–å·¥å…·</button>
            <button class="tab-button" data-tab="dashboard">æ•°æ®çœ‹æ¿</button>
        </div>
        
        <div id="coordinate-tool" class="tab-content active">
            <div class="image-section">
                <div class="image-controls">
                    <label for="file-input" class="file-upload-btn">
                        ğŸ“ é€‰æ‹©æœ¬åœ°å›¾ç‰‡
                    </label>
                    <input type="file" id="file-input" accept="image/*">
                    
                    <button class="url-load-btn" id="url-toggle-btn">
                        ğŸŒ é€šè¿‡URLåŠ è½½
                    </button>
                </div>
                
                <div class="url-input-container" id="url-input-container" style="display: none;">
                    <input type="text" id="image-url" placeholder="è¾“å…¥å›¾ç‰‡URL">
                    <button id="load-url-btn">åŠ è½½</button>
                </div>
                
                <div class="image-container-wrapper">
                    <div class="image-container">
                        <div class="image-loading" id="image-placeholder">
                            è¯·é€‰æ‹©æˆ–åŠ è½½å›¾ç‰‡
                        </div>
                        <img id="target-image" style="display: none;" alt="ç›®æ ‡å›¾ç‰‡">
                    </div>
                </div>
                
                <!-- å°†JSONæ•°æ®æ¿å—ç§»åˆ°å›¾ç‰‡ä¸‹æ–¹ -->
                <div class="data-section">
                    <h3>ç”Ÿæˆçš„JSONæ•°æ®</h3>
                    <div class="json-output" id="json-output">
                        // æ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º
                    </div>
                </div>
            </div>
            
            <div class="control-section">
                <div class="control-panel">
                    <!-- å•†å®¶åç§°è¾“å…¥æ¡† -->
                    <div class="form-group">
                        <label for="merchant-name">å•†å®¶åç§°</label>
                        <div class="merchant-input-container">
                            <input type="text" id="merchant-name" placeholder="é€‰æ‹©æˆ–è¾“å…¥å•†å®¶åç§°">
                            <div class="merchant-suggestions" id="merchant-suggestions">
                                <!-- å•†å®¶å»ºè®®å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="point1">ç¬¬ä¸€ä¸ªç‚¹åæ ‡</label>
                        <div class="coordinates">
                            <div class="coordinate-group">
                                <input type="text" id="point1-x" placeholder="Xåæ ‡" readonly>
                            </div>
                            <div class="coordinate-group">
                                <input type="text" id="point1-y" placeholder="Yåæ ‡" readonly>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="point2">ç¬¬äºŒä¸ªç‚¹åæ ‡</label>
                        <div class="coordinates">
                            <div class="coordinate-group">
                                <input type="text" id="point2-x" placeholder="Xåæ ‡" readonly>
                            </div>
                            <div class="coordinate-group">
                                <input type="text" id="point2-y" placeholder="Yåæ ‡" readonly>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="direction">é€‰æ‹©æ–¹å‘</label>
                        <div class="direction-select">
                            <select id="direction">
                                <option value="0">â†‘ å‘ä¸Š</option>
                                <option value="1">â†“ å‘ä¸‹</option>
                                <option value="2">â† å‘å·¦</option>
                                <option value="3">â†’ å‘å³</option>
                            </select>
                        </div>
                    </div>
                    
                    <button id="submit-btn">ç”ŸæˆJSONæ•°æ®</button>
                    
                    <!-- ç‚¹é€‰æ‹©çŠ¶æ€æŒ‡ç¤ºå™¨ -->
                    <div class="point-status incomplete" id="point-status">
                        <span class="point-status-icon">âš ï¸</span>
                        <span id="point-status-text">è¯·é€‰æ‹©ä¸¤ä¸ªç‚¹å¹¶è¾“å…¥å•†å®¶åç§°ä»¥å¯ç”¨æäº¤åŠŸèƒ½</span>
                    </div>
                    
                    <div class="action-buttons">
                        <button id="reset-btn">é‡ç½®åæ ‡ç‚¹</button>
                        <button id="copy-btn">å¤åˆ¶JSON</button>
                        <button id="submit-data-btn" disabled>æäº¤æ•°æ®</button>
                    </div>
                </div>
            </div>
            
            <!-- ä½¿ç”¨è¯´æ˜æ”¾åœ¨æœ€ä¸‹æ–¹ -->
            <div class="instructions">
                <h3>ä½¿ç”¨è¯´æ˜</h3>
                <ol>
                    <li><strong>åŠ è½½å›¾ç‰‡</strong>ï¼šé€šè¿‡"é€‰æ‹©æœ¬åœ°å›¾ç‰‡"æŒ‰é’®ä»æ‚¨çš„è®¾å¤‡ä¸­é€‰æ‹©å›¾ç‰‡ï¼Œæˆ–é€šè¿‡"é€šè¿‡URLåŠ è½½"æŒ‰é’®è¾“å…¥å›¾ç‰‡URLåœ°å€åŠ è½½å›¾ç‰‡ã€‚</li>
                    <li><strong>è¾“å…¥å•†å®¶åç§°</strong>ï¼šåœ¨å•†å®¶åç§°è¾“å…¥æ¡†ä¸­è¾“å…¥å•†å®¶åç§°ï¼Œæˆ–ä»ä¸‹æ‹‰å»ºè®®ä¸­é€‰æ‹©ä¸€ä¸ªå•†å®¶åç§°ã€‚</li>
                    <li><strong>é€‰æ‹©åæ ‡ç‚¹</strong>ï¼šåœ¨å›¾ç‰‡ä¸Šç‚¹å‡»é€‰æ‹©ç¬¬ä¸€ä¸ªåæ ‡ç‚¹ï¼ˆçº¢è‰²æ ‡è®°ï¼‰ï¼Œå†æ¬¡ç‚¹å‡»é€‰æ‹©ç¬¬äºŒä¸ªåæ ‡ç‚¹ï¼ˆç»¿è‰²æ ‡è®°ï¼‰ã€‚</li>
                    <li><strong>æŸ¥çœ‹åæ ‡ä¿¡æ¯</strong>ï¼šå°†é¼ æ ‡æ‚¬åœåœ¨å·²é€‰æ‹©çš„ç‚¹ä¸Šå¯ä»¥æŸ¥çœ‹è¯¥ç‚¹çš„åæ ‡ä¿¡æ¯ã€‚</li>
                    <li><strong>é€‰æ‹©æ–¹å‘</strong>ï¼šä»ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©æ–¹å‘ï¼ˆå‘ä¸Šã€å‘ä¸‹ã€å‘å·¦æˆ–å‘å³ï¼‰ã€‚</li>
                    <li><strong>ç”ŸæˆJSONæ•°æ®</strong>ï¼šç‚¹å‡»"ç”ŸæˆJSONæ•°æ®"æŒ‰é’®å°†å•†å®¶åç§°ã€åæ ‡ç‚¹å’Œæ–¹å‘ä¿¡æ¯è½¬æ¢ä¸ºJSONæ ¼å¼ã€‚</li>
                    <li><strong>æäº¤æ•°æ®</strong>ï¼šå½“æ‚¨é€‰æ‹©äº†ä¸¤ä¸ªç‚¹å¹¶è¾“å…¥äº†å•†å®¶åç§°åï¼Œ"æäº¤æ•°æ®"æŒ‰é’®å°†å¯ç”¨ï¼Œç‚¹å‡»å¯å°†æ•°æ®æäº¤åˆ°åç«¯æœåŠ¡å™¨ã€‚</li>
                    <li><strong>æ•°æ®éªŒè¯</strong>ï¼šç³»ç»Ÿä¼šéªŒè¯æ‚¨æ˜¯å¦å·²é€‰æ‹©ä¸¤ä¸ªç‚¹å¹¶è¾“å…¥å•†å®¶åç§°ï¼Œæœªå®Œæˆæ—¶å°†æ— æ³•æäº¤æ•°æ®ã€‚</li>
                    <li><strong>é‡ç½®æ“ä½œ</strong>ï¼šå¦‚éœ€é‡æ–°é€‰æ‹©ç‚¹ï¼Œå¯ç‚¹å‡»"é‡ç½®åæ ‡ç‚¹"æŒ‰é’®æ¸…é™¤å½“å‰é€‰æ‹©ã€‚</li>
                </ol>
                <p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šç¡®ä¿é€‰æ‹©çš„å›¾ç‰‡æ¸…æ™°å¯è§ï¼Œåæ ‡ç‚¹åº”å‡†ç¡®æ ‡è®°åœ¨æ‚¨éœ€è¦çš„ä½ç½®ã€‚æäº¤æ•°æ®åï¼Œç³»ç»Ÿä¼šæ ¹æ®åç«¯å“åº”æ˜¾ç¤ºç›¸åº”çš„æç¤ºä¿¡æ¯ã€‚</p>
            </div>
        </div>
        
        <div id="dashboard" class="tab-content">
            <div class="dashboard">
                <div class="dashboard-header">
                    <h2>è¿›å‡ºäººæ•°æ•°æ®çœ‹æ¿</h2>
                    <p>å¯è§†åŒ–åˆ†æåŒºåŸŸäººå‘˜æµåŠ¨æƒ…å†µ</p>
                </div>
                
                <div class="stats-cards">
                    <div class="stat-card">
                        <div class="stat-value" id="total-in">1,247</div>
                        <div class="stat-label">æ€»è¿›å…¥äººæ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-out">1,189</div>
                        <div class="stat-label">æ€»ç¦»å¼€äººæ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="net-flow">+58</div>
                        <div class="stat-label">å‡€æµå…¥äººæ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="peak-hour">14:00</div>
                        <div class="stat-label">é«˜å³°æœŸæ—¶æ®µ</div>
                    </div>
                </div>
                
                <div class="time-filter">
                    <button class="time-btn active" data-period="day">ä»Šæ—¥</button>
                    <button class="time-btn" data-period="week">æœ¬å‘¨</button>
                    <button class="time-btn" data-period="month">æœ¬æœˆ</button>
                </div>
                
                <div class="dashboard-content">
                    <div class="chart-container">
                        <div class="chart-title">è¿›å‡ºäººæ•°è¶‹åŠ¿</div>
                        <canvas id="flow-chart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-title">è¿›å‡ºäººæ•°å¯¹æ¯”</div>
                        <canvas id="comparison-chart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-title">æ—¶æ®µåˆ†å¸ƒ</div>
                        <canvas id="hourly-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- æç¤ºæ¡† -->
    <div class="notification" id="notification">
        <div class="notification-content">
            <span class="notification-icon" id="notification-icon">â„¹ï¸</span>
            <span id="notification-message">è¿™æ˜¯ä¸€æ¡æç¤ºä¿¡æ¯</span>
            <button class="notification-close" id="notification-close">âœ•</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tabåˆ‡æ¢åŠŸèƒ½
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab');
                    
                    // æ›´æ–°æŒ‰é’®çŠ¶æ€
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    // æ›´æ–°å†…å®¹æ˜¾ç¤º
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === tabId) {
                            content.classList.add('active');
                        }
                    });
                    
                    // å¦‚æœåˆ‡æ¢åˆ°æ•°æ®çœ‹æ¿ï¼Œåˆå§‹åŒ–å›¾è¡¨
                    if (tabId === 'dashboard') {
                        initializeCharts();
                    }
                });
            });
            
            // åæ ‡é€‰å–å·¥å…·åŠŸèƒ½
            const image = document.getElementById('target-image');
            const fileInput = document.getElementById('file-input');
            const urlToggleBtn = document.getElementById('url-toggle-btn');
            const urlInputContainer = document.getElementById('url-input-container');
            const imageUrl = document.getElementById('image-url');
            const loadUrlBtn = document.getElementById('load-url-btn');
            const imagePlaceholder = document.getElementById('image-placeholder');
            const imageContainer = document.querySelector('.image-container');
            const imageContainerWrapper = document.querySelector('.image-container-wrapper');
            
            const merchantNameInput = document.getElementById('merchant-name');
            const merchantSuggestions = document.getElementById('merchant-suggestions');
            
            const point1X = document.getElementById('point1-x');
            const point1Y = document.getElementById('point1-y');
            const point2X = document.getElementById('point2-x');
            const point2Y = document.getElementById('point2-y');
            const directionSelect = document.getElementById('direction');
            const submitBtn = document.getElementById('submit-btn');
            const resetBtn = document.getElementById('reset-btn');
            const copyBtn = document.getElementById('copy-btn');
            const submitDataBtn = document.getElementById('submit-data-btn');
            const jsonOutput = document.getElementById('json-output');
            const pointStatus = document.getElementById('point-status');
            const pointStatusText = document.getElementById('point-status-text');
            
            let points = {
                point1: null,
                point2: null
            };
            let currentPoint = 1;
            let tooltips = {};
            
            // å•†å®¶åç§°æ•°æ®
            const merchantNames = [
                "åŒ—äº¬ç‹åºœäº•ç™¾è´§",
                "ä¸Šæµ·å—äº¬è·¯æ­¥è¡Œè¡—",
                "å¹¿å·å¤©æ²³åŸ",
                "æ·±åœ³åå¼ºåŒ—ç”µå­å¸‚åœº",
                "æˆéƒ½æ˜¥ç†™è·¯",
                "é‡åº†è§£æ”¾ç¢‘",
                "æ­¦æ±‰æ±‰æ­£è¡—",
                "è¥¿å®‰é’Ÿæ¥¼å•†åœº",
                "æ­å·è¥¿æ¹–é“¶æ³°",
                "å—äº¬æ–°è¡—å£"
            ];
            
            // åˆå§‹åŒ–å•†å®¶åç§°å»ºè®®
            function initializeMerchantSuggestions() {
                merchantNames.forEach(name => {
                    const suggestion = document.createElement('div');
                    suggestion.className = 'merchant-suggestion';
                    suggestion.textContent = name;
                    suggestion.addEventListener('click', function() {
                        merchantNameInput.value = name;
                        hideMerchantSuggestions();
                        updateSubmitStatus();
                    });
                    merchantSuggestions.appendChild(suggestion);
                });
            }
            
            // æ˜¾ç¤ºå•†å®¶åç§°å»ºè®®
            function showMerchantSuggestions() {
                merchantSuggestions.style.display = 'block';
            }
            
            // éšè—å•†å®¶åç§°å»ºè®®
            function hideMerchantSuggestions() {
                merchantSuggestions.style.display = 'none';
            }
            
            // è¿‡æ»¤å•†å®¶åç§°å»ºè®®
            function filterMerchantSuggestions(query) {
                const suggestions = document.querySelectorAll('.merchant-suggestion');
                let hasMatch = false;
                
                suggestions.forEach(suggestion => {
                    if (suggestion.textContent.toLowerCase().includes(query.toLowerCase())) {
                        suggestion.style.display = 'block';
                        hasMatch = true;
                    } else {
                        suggestion.style.display = 'none';
                    }
                });
                
                return hasMatch;
            }
            
            // æ›´æ–°æäº¤çŠ¶æ€
            function updateSubmitStatus() {
                const merchantName = merchantNameInput.value.trim();
                
                if (points.point1 && points.point2 && merchantName) {
                    // ä¸¤ä¸ªç‚¹éƒ½å·²é€‰æ‹©ä¸”å•†å®¶åç§°å·²è¾“å…¥
                    pointStatus.className = 'point-status complete';
                    pointStatusText.textContent = 'å·²é€‰æ‹©ä¸¤ä¸ªç‚¹å¹¶è¾“å…¥å•†å®¶åç§°ï¼Œå¯ä»¥æäº¤æ•°æ®';
                    submitDataBtn.disabled = false;
                } else if (points.point1 && points.point2) {
                    // åªé€‰æ‹©ä¸¤ä¸ªç‚¹ï¼Œä½†æœªè¾“å…¥å•†å®¶åç§°
                    pointStatus.className = 'point-status incomplete';
                    pointStatusText.textContent = 'å·²é€‰æ‹©ä¸¤ä¸ªç‚¹ï¼Œè¯·è¾“å…¥å•†å®¶åç§°';
                    submitDataBtn.disabled = true;
                } else if (points.point1) {
                    // åªé€‰æ‹©äº†ä¸€ä¸ªç‚¹
                    pointStatus.className = 'point-status incomplete';
                    pointStatusText.textContent = 'å·²é€‰æ‹©ç¬¬ä¸€ä¸ªç‚¹ï¼Œè¯·é€‰æ‹©ç¬¬äºŒä¸ªç‚¹';
                    submitDataBtn.disabled = true;
                } else {
                    // æ²¡æœ‰é€‰æ‹©ç‚¹
                    pointStatus.className = 'point-status incomplete';
                    pointStatusText.textContent = 'è¯·é€‰æ‹©ä¸¤ä¸ªç‚¹å¹¶è¾“å…¥å•†å®¶åç§°ä»¥å¯ç”¨æäº¤åŠŸèƒ½';
                    submitDataBtn.disabled = true;
                }
            }
            
            // å•†å®¶åç§°è¾“å…¥äº‹ä»¶
            merchantNameInput.addEventListener('input', function() {
                const query = this.value;
                if (query.length > 0) {
                    const hasMatch = filterMerchantSuggestions(query);
                    if (hasMatch) {
                        showMerchantSuggestions();
                    } else {
                        hideMerchantSuggestions();
                    }
                } else {
                    hideMerchantSuggestions();
                }
                updateSubmitStatus();
            });
            
            // å•†å®¶åç§°ç„¦ç‚¹äº‹ä»¶
            merchantNameInput.addEventListener('focus', function() {
                if (this.value.length > 0) {
                    const hasMatch = filterMerchantSuggestions(this.value);
                    if (hasMatch) {
                        showMerchantSuggestions();
                    }
                } else {
                    // æ˜¾ç¤ºæ‰€æœ‰å»ºè®®
                    const suggestions = document.querySelectorAll('.merchant-suggestion');
                    suggestions.forEach(suggestion => {
                        suggestion.style.display = 'block';
                    });
                    showMerchantSuggestions();
                }
            });
            
            // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹éšè—å•†å®¶åç§°å»ºè®®
            document.addEventListener('click', function(e) {
                if (!merchantNameInput.contains(e.target) && !merchantSuggestions.contains(e.target)) {
                    hideMerchantSuggestions();
                }
            });
            
            // åˆ‡æ¢URLè¾“å…¥æ¡†æ˜¾ç¤º
            urlToggleBtn.addEventListener('click', function() {
                if (urlInputContainer.style.display === 'none') {
                    urlInputContainer.style.display = 'flex';
                    urlToggleBtn.textContent = 'å–æ¶ˆURLåŠ è½½';
                } else {
                    urlInputContainer.style.display = 'none';
                    urlToggleBtn.textContent = 'ğŸŒ é€šè¿‡URLåŠ è½½';
                }
            });
            
            // å¤„ç†æ–‡ä»¶é€‰æ‹©
            fileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        loadImage(event.target.result);
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // å¤„ç†URLåŠ è½½
            loadUrlBtn.addEventListener('click', function() {
                const url = imageUrl.value.trim();
                if (url) {
                    loadImage(url);
                } else {
                    showNotification('è¯·è¾“å…¥æœ‰æ•ˆçš„å›¾ç‰‡URL', 'warning');
                }
            });
            
            // åŠ è½½å›¾ç‰‡
            function loadImage(src) {
                imagePlaceholder.textContent = 'åŠ è½½ä¸­...';
                image.style.display = 'none';
                
                image.onload = function() {
                    image.style.display = 'block';
                    imagePlaceholder.style.display = 'none';
                    
                    // è°ƒæ•´å®¹å™¨å¤§å°ä»¥åŒ¹é…å›¾ç‰‡
                    adjustContainerSize();
                    resetPoints();
                };
                
                image.onerror = function() {
                    imagePlaceholder.textContent = 'å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥URLæˆ–é€‰æ‹©å…¶ä»–å›¾ç‰‡';
                    image.style.display = 'none';
                    showNotification('å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥URLæˆ–é€‰æ‹©å…¶ä»–å›¾ç‰‡', 'error');
                };
                
                image.src = src;
            }
            
            // è°ƒæ•´å®¹å™¨å¤§å°ä»¥åŒ¹é…å›¾ç‰‡
            function adjustContainerSize() {
                // è·å–å›¾ç‰‡çš„å®é™…æ˜¾ç¤ºå°ºå¯¸
                const imgWidth = image.offsetWidth;
                const imgHeight = image.offsetHeight;
                
                // è®¾ç½®å®¹å™¨å¤§å°ä¸å›¾ç‰‡ä¸€è‡´
                imageContainer.style.width = imgWidth + 'px';
                imageContainer.style.height = imgHeight + 'px';
                imageContainerWrapper.style.width = imgWidth + 'px';
                imageContainerWrapper.style.height = imgHeight + 'px';
            }
            
            // å›¾ç‰‡ç‚¹å‡»äº‹ä»¶å¤„ç†
            image.addEventListener('click', function(e) {
                if (image.style.display === 'none') return;
                
                // è·å–å›¾ç‰‡ç›¸å¯¹äºå®¹å™¨çš„ä½ç½®
                const rect = image.getBoundingClientRect();
                const containerRect = imageContainer.getBoundingClientRect();
                
                // è®¡ç®—ç›¸å¯¹äºå›¾ç‰‡çš„åæ ‡
                const x = Math.round(e.clientX - containerRect.left);
                const y = Math.round(e.clientY - containerRect.top);
                
                // ä¿å­˜åæ ‡ç‚¹
                if (currentPoint === 1) {
                    points.point1 = { x, y };
                    point1X.value = x;
                    point1Y.value = y;
                    currentPoint = 2;
                    addPointMarker(x, y, 1);
                } else {
                    points.point2 = { x, y };
                    point2X.value = x;
                    point2Y.value = y;
                    currentPoint = 1;
                    addPointMarker(x, y, 2);
                }
                
                // æ›´æ–°æäº¤çŠ¶æ€
                updateSubmitStatus();
            });
            
            // æ·»åŠ åæ ‡ç‚¹æ ‡è®°
            function addPointMarker(x, y, pointNumber) {
                // ç§»é™¤æ—§çš„æ ‡è®°
                const oldMarker = document.querySelector(`.point-${pointNumber}`);
                if (oldMarker) oldMarker.remove();
                
                // åˆ›å»ºæ–°æ ‡è®°
                const marker = document.createElement('div');
                marker.className = `point-marker point-${pointNumber}`;
                marker.style.left = `${x}px`;
                marker.style.top = `${y}px`;
                marker.dataset.pointNumber = pointNumber;
                
                // ä¸ºæ ‡è®°æ·»åŠ æ‚¬åœäº‹ä»¶
                marker.addEventListener('mouseenter', function() {
                    showTooltip(pointNumber, x, y);
                });
                
                marker.addEventListener('mouseleave', function() {
                    hideTooltip(pointNumber);
                });
                
                // æ·»åŠ åˆ°å›¾ç‰‡å®¹å™¨
                imageContainer.appendChild(marker);
                
                // åˆ›å»ºå·¥å…·æç¤ºï¼ˆä½†ä¸æ˜¾ç¤ºï¼‰
                const tooltip = document.createElement('div');
                tooltip.className = 'point-tooltip';
                tooltip.textContent = `ç‚¹${pointNumber} (${x}, ${y})`;
                tooltip.id = `tooltip-${pointNumber}`;
                tooltip.style.display = 'none';
                imageContainer.appendChild(tooltip);
                
                // ä¿å­˜å·¥å…·æç¤ºå¼•ç”¨
                tooltips[pointNumber] = tooltip;
            }
            
            // æ˜¾ç¤ºå·¥å…·æç¤º
            function showTooltip(pointNumber, x, y) {
                const tooltip = tooltips[pointNumber];
                if (!tooltip) return;
                
                // ç¡®å®šå·¥å…·æç¤ºä½ç½®ï¼Œç¡®ä¿å®Œå…¨æ˜¾ç¤º
                const tooltipPosition = calculateTooltipPosition(x, y);
                tooltip.className = `point-tooltip ${tooltipPosition}`;
                tooltip.style.left = `${x}px`;
                tooltip.style.top = `${y}px`;
                tooltip.style.display = 'block';
                
                // ä½¿ç”¨setTimeoutç¡®ä¿æ˜¾ç¤ºæ ·å¼ç”Ÿæ•ˆåå†æ·»åŠ showç±»
                setTimeout(() => {
                    tooltip.classList.add('show');
                }, 10);
            }
            
            // éšè—å·¥å…·æç¤º
            function hideTooltip(pointNumber) {
                const tooltip = tooltips[pointNumber];
                if (!tooltip) return;
                
                tooltip.classList.remove('show');
                
                // ç­‰å¾…åŠ¨ç”»å®Œæˆåå†éšè—
                setTimeout(() => {
                    tooltip.style.display = 'none';
                }, 300);
            }
            
            // è®¡ç®—å·¥å…·æç¤ºä½ç½®ï¼Œç¡®ä¿å®Œå…¨æ˜¾ç¤º
            function calculateTooltipPosition(x, y) {
                const containerRect = imageContainer.getBoundingClientRect();
                const containerWidth = containerRect.width;
                const containerHeight = containerRect.height;
                
                // é»˜è®¤ä½ç½®åœ¨ç‚¹ä¸Šæ–¹
                let position = 'top';
                
                // å¦‚æœç‚¹é è¿‘é¡¶éƒ¨ï¼Œå·¥å…·æç¤ºæ˜¾ç¤ºåœ¨ä¸‹æ–¹
                if (y < 80) {
                    position = 'bottom';
                }
                // å¦‚æœç‚¹é è¿‘å·¦ä¾§ï¼Œå·¥å…·æç¤ºæ˜¾ç¤ºåœ¨å³ä¾§
                else if (x < 120) {
                    position = 'right';
                }
                // å¦‚æœç‚¹é è¿‘å³ä¾§ï¼Œå·¥å…·æç¤ºæ˜¾ç¤ºåœ¨å·¦ä¾§
                else if (x > containerWidth - 120) {
                    position = 'left';
                }
                
                return position;
            }
            
            // é‡ç½®åæ ‡ç‚¹
            function resetPoints() {
                points.point1 = null;
                points.point2 = null;
                currentPoint = 1;
                
                point1X.value = '';
                point1Y.value = '';
                point2X.value = '';
                point2Y.value = '';
                
                // ç§»é™¤æ‰€æœ‰æ ‡è®°å’Œå·¥å…·æç¤º
                document.querySelectorAll('.point-marker, .point-tooltip').forEach(el => el.remove());
                
                // æ¸…ç©ºå·¥å…·æç¤ºå¼•ç”¨
                tooltips = {};
                
                jsonOutput.textContent = '// æ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º';
                
                // æ›´æ–°æäº¤çŠ¶æ€
                updateSubmitStatus();
            }
            
            // æäº¤æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            submitBtn.addEventListener('click', function() {
                // éªŒè¯æ•°æ®
                if (!points.point1 || !points.point2) {
                    showNotification('è¯·å…ˆåœ¨å›¾ç‰‡ä¸Šé€‰æ‹©ä¸¤ä¸ªç‚¹ï¼', 'warning');
                    return;
                }
                
                const merchantName = merchantNameInput.value.trim();
                if (!merchantName) {
                    showNotification('è¯·è¾“å…¥å•†å®¶åç§°ï¼', 'warning');
                    return;
                }
                
                // è·å–æ–¹å‘
                const direction = directionSelect.value;
                
                // åˆ›å»ºJSONæ•°æ®
                const jsonData = {
                    merchant: merchantName,
                    x1: points.point1.x.toString(),
                    y1: points.point1.y.toString(),
                    x2: points.point2.x.toString(),
                    y2: points.point2.y.toString(),
                    direction: direction
                };
                
                // æ˜¾ç¤ºJSONæ•°æ®
                jsonOutput.textContent = JSON.stringify(jsonData, null, 2);
                
                showNotification('JSONæ•°æ®ç”ŸæˆæˆåŠŸï¼', 'success');
            });
            
            // é‡ç½®æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            resetBtn.addEventListener('click', resetPoints);
            
            // å¤åˆ¶æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            copyBtn.addEventListener('click', function() {
                if (jsonOutput.textContent === '// æ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º') {
                    showNotification('è¯·å…ˆç”ŸæˆJSONæ•°æ®ï¼', 'warning');
                    return;
                }
                
                navigator.clipboard.writeText(jsonOutput.textContent)
                    .then(() => {
                        showNotification('JSONæ•°æ®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼', 'success');
                    })
                    .catch(err => {
                        console.error('å¤åˆ¶å¤±è´¥: ', err);
                        showNotification('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶æ–‡æœ¬', 'error');
                    });
            });
            
            // æäº¤æ•°æ®æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            submitDataBtn.addEventListener('click', function() {
                if (!points.point1 || !points.point2) {
                    showNotification('è¯·å…ˆåœ¨å›¾ç‰‡ä¸Šé€‰æ‹©ä¸¤ä¸ªç‚¹ï¼', 'warning');
                    return;
                }
                
                const merchantName = merchantNameInput.value.trim();
                if (!merchantName) {
                    showNotification('è¯·è¾“å…¥å•†å®¶åç§°ï¼', 'warning');
                    return;
                }
                
                if (jsonOutput.textContent === '// æ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º') {
                    showNotification('è¯·å…ˆç”ŸæˆJSONæ•°æ®ï¼', 'warning');
                    return;
                }
                
                // è·å–JSONæ•°æ®
                const jsonData = jsonOutput.textContent;
                
                // æ˜¾ç¤ºæäº¤ä¸­çŠ¶æ€
                submitDataBtn.disabled = true;
                submitDataBtn.textContent = 'æäº¤ä¸­...';

                fetch('http://localhost:8080/erkai/visualnet/set', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(jsonData)
                }).then(response => {
                    return response.json()
                }).then(data => {
                    if (data.status === 'success') {
                        showNotification('Success: ' + data.message, 'success');
                    } else {
                        showNotification('æäº¤å®Œæˆä½†æœ‰è­¦å‘Š: ' + data.message, 'warning');
                    }

                }).finally(() => {
                     // æ¢å¤æŒ‰é’®çŠ¶æ€
                    submitDataBtn.disabled = false;
                    submitDataBtn.textContent = 'æäº¤æ•°æ®';
                })
                
                // æ¨¡æ‹Ÿå‘åç«¯æäº¤æ•°æ®
                // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥æ›¿æ¢ä¸ºçœŸå®çš„APIç«¯ç‚¹
                // simulateBackendSubmit(jsonData)
                //     .then(response => {
                //         // æ ¹æ®çŠ¶æ€ç æ˜¾ç¤ºä¸åŒçš„æç¤º
                //         if (response.status >= 200 && response.status < 300) {
                //             showNotification('æ•°æ®æäº¤æˆåŠŸï¼', 'success');
                //         } else if (response.status >= 400 && response.status < 500) {
                //             showNotification('æäº¤å¤±è´¥ï¼šå®¢æˆ·ç«¯é”™è¯¯ ' + response.status, 'error');
                //         } else if (response.status >= 500) {
                //             showNotification('æäº¤å¤±è´¥ï¼šæœåŠ¡å™¨é”™è¯¯ ' + response.status, 'error');
                //         } else {
                //             showNotification('æäº¤å®Œæˆï¼ŒçŠ¶æ€ç ï¼š' + response.status, 'info');
                //         }
                //     })
                //     .catch(error => {
                //         showNotification('æäº¤å¤±è´¥ï¼š' + error.message, 'error');
                //     })
                //     .finally(() => {
                //         // æ¢å¤æŒ‰é’®çŠ¶æ€
                //         submitDataBtn.disabled = false;
                //         submitDataBtn.textContent = 'æäº¤æ•°æ®';
                //     });
            });
            
            // æ¨¡æ‹Ÿå‘åç«¯æäº¤æ•°æ®
            function simulateBackendSubmit(data) {
                return new Promise((resolve, reject) => {
                    // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
                    setTimeout(() => {
                        // éšæœºç”ŸæˆçŠ¶æ€ç æ¥æ¨¡æ‹Ÿä¸åŒå“åº”
                        const statusCodes = [200, 201, 400, 401, 403, 404, 500, 502];
                        const randomStatus = statusCodes[Math.floor(Math.random() * statusCodes.length)];
                        
                        // æ¨¡æ‹ŸæˆåŠŸæˆ–å¤±è´¥
                        if (randomStatus < 300) {
                            resolve({
                                status: randomStatus,
                                message: 'æ•°æ®æäº¤æˆåŠŸ'
                            });
                        } else {
                            reject({
                                status: randomStatus,
                                message: 'æäº¤å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š' + randomStatus
                            });
                        }
                    }, 1500);
                });
            }
            
            // æç¤ºæ¡†åŠŸèƒ½
            const notification = document.getElementById('notification');
            const notificationIcon = document.getElementById('notification-icon');
            const notificationMessage = document.getElementById('notification-message');
            const notificationClose = document.getElementById('notification-close');
            
            // æ˜¾ç¤ºæç¤ºæ¡†
            function showNotification(message, type) {
                // è®¾ç½®æ¶ˆæ¯å’Œç±»å‹
                notificationMessage.textContent = message;
                notification.className = `notification ${type}`;
                
                // è®¾ç½®å›¾æ ‡
                let icon = 'â„¹ï¸';
                if (type === 'success') icon = 'âœ…';
                else if (type === 'error') icon = 'âŒ';
                else if (type === 'warning') icon = 'âš ï¸';
                notificationIcon.textContent = icon;
                
                // æ˜¾ç¤ºæç¤ºæ¡†
                notification.classList.add('show');
                
                // 5ç§’åè‡ªåŠ¨éšè—
                setTimeout(() => {
                    hideNotification();
                }, 5000);
            }
            
            // éšè—æç¤ºæ¡†
            function hideNotification() {
                notification.classList.remove('show');
            }
            
            // ç‚¹å‡»å…³é—­æŒ‰é’®éšè—æç¤ºæ¡†
            notificationClose.addEventListener('click', hideNotification);
            
            // çª—å£å¤§å°å˜åŒ–æ—¶é‡æ–°è°ƒæ•´å®¹å™¨å¤§å°
            window.addEventListener('resize', function() {
                if (image.style.display !== 'none') {
                    adjustContainerSize();
                }
            });
            
            // æ•°æ®çœ‹æ¿åŠŸèƒ½
            let flowChart, comparisonChart, hourlyChart;
            
            // åˆå§‹åŒ–å›¾è¡¨
            function initializeCharts() {
                // è¿›å‡ºäººæ•°è¶‹åŠ¿å›¾
                const flowCtx = document.getElementById('flow-chart').getContext('2d');
                flowChart = new Chart(flowCtx, {
                    type: 'line',
                    data: {
                        labels: ['08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00'],
                        datasets: [
                            {
                                label: 'è¿›å…¥äººæ•°',
                                data: [65, 78, 90, 81, 56, 55, 120, 95, 80, 70, 60],
                                borderColor: '#2ed573',
                                backgroundColor: 'rgba(46, 213, 115, 0.1)',
                                tension: 0.4,
                                fill: true
                            },
                            {
                                label: 'ç¦»å¼€äººæ•°',
                                data: [45, 62, 70, 65, 80, 75, 95, 85, 70, 65, 75],
                                borderColor: '#ff4757',
                                backgroundColor: 'rgba(255, 71, 87, 0.1)',
                                tension: 0.4,
                                fill: true
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            title: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
                
                // è¿›å‡ºäººæ•°å¯¹æ¯”å›¾
                const comparisonCtx = document.getElementById('comparison-chart').getContext('2d');
                comparisonChart = new Chart(comparisonCtx, {
                    type: 'bar',
                    data: {
                        labels: ['å…¥å£A', 'å…¥å£B', 'å…¥å£C', 'å‡ºå£A', 'å‡ºå£B'],
                        datasets: [{
                            label: 'äººæ•°',
                            data: [320, 190, 280, 210, 170],
                            backgroundColor: [
                                'rgba(106, 17, 203, 0.7)',
                                'rgba(37, 117, 252, 0.7)',
                                'rgba(46, 213, 115, 0.7)',
                                'rgba(255, 71, 87, 0.7)',
                                'rgba(255, 165, 0, 0.7)'
                            ],
                            borderColor: [
                                'rgba(106, 17, 203, 1)',
                                'rgba(37, 117, 252, 1)',
                                'rgba(46, 213, 115, 1)',
                                'rgba(255, 71, 87, 1)',
                                'rgba(255, 165, 0, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
                
                // æ—¶æ®µåˆ†å¸ƒå›¾
                const hourlyCtx = document.getElementById('hourly-chart').getContext('2d');
                hourlyChart = new Chart(hourlyCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['ä¸Šåˆ (8-12)', 'ä¸­åˆ (12-14)', 'ä¸‹åˆ (14-18)', 'æ™šä¸Š (18-22)'],
                        datasets: [{
                            data: [35, 25, 30, 10],
                            backgroundColor: [
                                'rgba(106, 17, 203, 0.7)',
                                'rgba(37, 117, 252, 0.7)',
                                'rgba(46, 213, 115, 0.7)',
                                'rgba(255, 71, 87, 0.7)'
                            ],
                            borderColor: [
                                'rgba(106, 17, 203, 1)',
                                'rgba(37, 117, 252, 1)',
                                'rgba(46, 213, 115, 1)',
                                'rgba(255, 71, 87, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }
            
            // æ—¶é—´ç­›é€‰æŒ‰é’®äº‹ä»¶
            const timeButtons = document.querySelectorAll('.time-btn');
            timeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    timeButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    // è¿™é‡Œå¯ä»¥æ·»åŠ æ ¹æ®æ—¶é—´ç­›é€‰æ›´æ–°å›¾è¡¨çš„é€»è¾‘
                    const period = this.getAttribute('data-period');
                    updateChartsByPeriod(period);
                });
            });
            
            // æ ¹æ®æ—¶é—´ç­›é€‰æ›´æ–°å›¾è¡¨
            function updateChartsByPeriod(period) {
                // æ¨¡æ‹Ÿä¸åŒæ—¶é—´å‘¨æœŸçš„æ•°æ®
                let flowData, comparisonData, hourlyData;
                
                switch(period) {
                    case 'day':
                        flowData = {
                            in: [65, 78, 90, 81, 56, 55, 120, 95, 80, 70, 60],
                            out: [45, 62, 70, 65, 80, 75, 95, 85, 70, 65, 75]
                        };
                        comparisonData = [320, 190, 280, 210, 170];
                        hourlyData = [35, 25, 30, 10];
                        document.getElementById('total-in').textContent = '1,247';
                        document.getElementById('total-out').textContent = '1,189';
                        document.getElementById('net-flow').textContent = '+58';
                        break;
                    case 'week':
                        flowData = {
                            in: [450, 520, 480, 510, 490, 530, 500],
                            out: [420, 480, 460, 490, 470, 510, 480]
                        };
                        comparisonData = [2200, 1300, 1900, 1500, 1200];
                        hourlyData = [30, 20, 35, 15];
                        document.getElementById('total-in').textContent = '3,480';
                        document.getElementById('total-out').textContent = '3,310';
                        document.getElementById('net-flow').textContent = '+170';
                        break;
                    case 'month':
                        flowData = {
                            in: [14500, 15200, 14800, 15100, 14900, 15300, 15000],
                            out: [14200, 14800, 14600, 14900, 14700, 15100, 14800]
                        };
                        comparisonData = [13200, 7800, 11400, 9000, 7200];
                        hourlyData = [28, 22, 38, 12];
                        document.getElementById('total-in').textContent = '104,800';
                        document.getElementById('total-out').textContent = '103,100';
                        document.getElementById('net-flow').textContent = '+1,700';
                        break;
                }
                
                // æ›´æ–°å›¾è¡¨æ•°æ®
                if (flowChart) {
                    flowChart.data.datasets[0].data = flowData.in;
                    flowChart.data.datasets[1].data = flowData.out;
                    flowChart.update();
                }
                
                if (comparisonChart) {
                    comparisonChart.data.datasets[0].data = comparisonData;
                    comparisonChart.update();
                }
                
                if (hourlyChart) {
                    hourlyChart.data.datasets[0].data = hourlyData;
                    hourlyChart.update();
                }
            }
            
            // åˆå§‹åŒ–å•†å®¶åç§°å»ºè®®
            initializeMerchantSuggestions();
        });
    </script>
</body>
</html>